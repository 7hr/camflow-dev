------------------------
security/provenance/fs.c
------------------------
WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#89: FILE: security/provenance/fs.c:89:
+#define declare_write_flag_fcn(fcn_name, flag)			    \
+	static ssize_t fcn_name(struct file *file,		    \
+				const char __user *buf,		    \
+				size_t count,			    \
+				loff_t *ppos)			    \
+	{							    \
+		return __write_flag(file, buf, count, ppos, &flag); \
+	}

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#98: FILE: security/provenance/fs.c:98:
+#define declare_read_flag_fcn(fcn_name, flag)			  \
+	static ssize_t fcn_name(struct file *filp,		  \
+				char __user *buf,		  \
+				size_t count,			  \
+				loff_t *ppos)			  \
+	{							  \
+		return __read_flag(filp, buf, count, ppos, flag); \
+	}

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#389: FILE: security/provenance/fs.c:389:
+#define declare_write_filter_fcn(fcn_name, filter)		  \
+	static ssize_t fcn_name(struct file *file,		  \
+				const char __user *buf,		  \
+				size_t count,			  \
+				loff_t *ppos)			  \
+	{							  \
+		return __write_filter(file, buf, count, &filter); \
+	}

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#398: FILE: security/provenance/fs.c:398:
+#define declare_read_filter_fcn(fcn_name, filter)		\
+	static ssize_t fcn_name(struct file *filp,		\
+				char __user *buf,		\
+				size_t count,			\
+				loff_t *ppos)			\
+	{							\
+		return __read_filter(filp, buf, count, filter);	\
+	}

WARNING:LONG_LINE: line over 80 characters
#565: FILE: security/provenance/fs.c:565:
+	if (copy_from_user(&(f->filter), buf, sizeof(struct prov_ipv4_filter))) {

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#602: FILE: security/provenance/fs.c:602:
+#define declare_write_ipv4_filter_fcn(fcn_name, filter)		       \
+	static ssize_t fcn_name(struct file *file,		       \
+				const char __user *buf,		       \
+				size_t count,			       \
+				loff_t *ppos)			       \
+	{							       \
+		return __write_ipv4_filter(file, buf, count, &filter); \
+	}

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#611: FILE: security/provenance/fs.c:611:
+#define declare_reader_ipv4_filter_fcn(fcn_name, filter)	      \
+	static ssize_t fcn_name(struct file *filp,		      \
+				char __user *buf,		      \
+				size_t count,			      \
+				loff_t *ppos)			      \
+	{							      \
+		return __read_ipv4_filter(filp, buf, count, &filter); \
+	}

WARNING:LONG_LINE: line over 80 characters
#672: FILE: security/provenance/fs.c:672:
+#define declare_generic_filter_write(function_name, filters, info, add_function, delete_function) \

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#672: FILE: security/provenance/fs.c:672:
+#define declare_generic_filter_write(function_name, filters, info, add_function, delete_function) \
+	static ssize_t function_name(struct file *file,						  \
+				     const char __user *buf,					  \
+				     size_t count,						  \
+				     loff_t *ppos)						  \
+	{											  \
+		struct filters *s;								  \
+		if (count < sizeof(struct info))						  \
+			return -ENOMEM;								  \
+		s = kzalloc(sizeof(struct filters), GFP_KERNEL);				  \
+		if (!s)										  \
+			return -ENOMEM;								  \
+		if (copy_from_user(&s->filter, buf, sizeof(struct info))) {			  \
+			kfree(s);								  \
+			return -EAGAIN;								  \
+		}										  \
+		if ((s->filter.op & PROV_SET_DELETE) != PROV_SET_DELETE)			  \
+			add_function(s); else							  \
+			delete_function(s); return sizeof(struct filters);			  \
+	}

WARNING:LONG_LINE: line over 80 characters
#673: FILE: security/provenance/fs.c:673:
+	static ssize_t function_name(struct file *file,						  \

WARNING:LONG_LINE: line over 80 characters
#674: FILE: security/provenance/fs.c:674:
+				     const char __user *buf,					  \

WARNING:LONG_LINE: line over 80 characters
#675: FILE: security/provenance/fs.c:675:
+				     size_t count,						  \

WARNING:LONG_LINE: line over 80 characters
#676: FILE: security/provenance/fs.c:676:
+				     loff_t *ppos)						  \

WARNING:LONG_LINE: line over 80 characters
#677: FILE: security/provenance/fs.c:677:
+	{											  \

WARNING:LONG_LINE: line over 80 characters
#678: FILE: security/provenance/fs.c:678:
+		struct filters *s;								  \

WARNING:LONG_LINE: line over 80 characters
#679: FILE: security/provenance/fs.c:679:
+		if (count < sizeof(struct info))						  \

WARNING:LONG_LINE: line over 80 characters
#680: FILE: security/provenance/fs.c:680:
+			return -ENOMEM;								  \

WARNING:LONG_LINE: line over 80 characters
#681: FILE: security/provenance/fs.c:681:
+		s = kzalloc(sizeof(struct filters), GFP_KERNEL);				  \

WARNING:LONG_LINE: line over 80 characters
#682: FILE: security/provenance/fs.c:682:
+		if (!s)										  \

WARNING:LONG_LINE: line over 80 characters
#683: FILE: security/provenance/fs.c:683:
+			return -ENOMEM;								  \

WARNING:LONG_LINE: line over 80 characters
#684: FILE: security/provenance/fs.c:684:
+		if (copy_from_user(&s->filter, buf, sizeof(struct info))) {			  \

WARNING:LONG_LINE: line over 80 characters
#685: FILE: security/provenance/fs.c:685:
+			kfree(s);								  \

WARNING:LONG_LINE: line over 80 characters
#686: FILE: security/provenance/fs.c:686:
+			return -EAGAIN;								  \

WARNING:LONG_LINE: line over 80 characters
#687: FILE: security/provenance/fs.c:687:
+		}										  \

WARNING:LONG_LINE: line over 80 characters
#688: FILE: security/provenance/fs.c:688:
+		if ((s->filter.op & PROV_SET_DELETE) != PROV_SET_DELETE)			  \

WARNING:LONG_LINE: line over 80 characters
#689: FILE: security/provenance/fs.c:689:
+			add_function(s); else							  \

WARNING:LONG_LINE: line over 80 characters
#690: FILE: security/provenance/fs.c:690:
+			delete_function(s); return sizeof(struct filters);			  \

WARNING:LONG_LINE: line over 80 characters
#693: FILE: security/provenance/fs.c:693:
+#define declare_generic_filter_read(function_name, filters, info)			    \

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#693: FILE: security/provenance/fs.c:693:
+#define declare_generic_filter_read(function_name, filters, info)			    \
+	static ssize_t function_name(struct file *filp,					    \
+				     char __user *buf,					    \
+				     size_t count,					    \
+				     loff_t *ppos)					    \
+	{										    \
+		struct list_head *listentry, *listtmp;					    \
+		struct filters *tmp;							    \
+		size_t pos = 0;								    \
+		if (count < sizeof(struct info)) {					    \
+			return -ENOMEM; }						    \
+		list_for_each_safe(listentry, listtmp, &filters) {			    \
+			tmp = list_entry(listentry, struct filters, list);		    \
+			if (count < pos + sizeof(struct info)) {			    \
+				return -ENOMEM; }					    \
+			if (copy_to_user(buf + pos, &(tmp->filter), sizeof(struct info))) { \
+				return -EAGAIN; }					    \
+			pos += sizeof(struct info);					    \
+		}									    \
+		return pos;								    \
+	}

WARNING:LONG_LINE: line over 80 characters
#694: FILE: security/provenance/fs.c:694:
+	static ssize_t function_name(struct file *filp,					    \

WARNING:LONG_LINE: line over 80 characters
#695: FILE: security/provenance/fs.c:695:
+				     char __user *buf,					    \

WARNING:LONG_LINE: line over 80 characters
#696: FILE: security/provenance/fs.c:696:
+				     size_t count,					    \

WARNING:LONG_LINE: line over 80 characters
#697: FILE: security/provenance/fs.c:697:
+				     loff_t *ppos)					    \

WARNING:LONG_LINE: line over 80 characters
#698: FILE: security/provenance/fs.c:698:
+	{										    \

WARNING:LONG_LINE: line over 80 characters
#699: FILE: security/provenance/fs.c:699:
+		struct list_head *listentry, *listtmp;					    \

WARNING:LONG_LINE: line over 80 characters
#700: FILE: security/provenance/fs.c:700:
+		struct filters *tmp;							    \

WARNING:LONG_LINE: line over 80 characters
#701: FILE: security/provenance/fs.c:701:
+		size_t pos = 0;								    \

WARNING:LONG_LINE: line over 80 characters
#702: FILE: security/provenance/fs.c:702:
+		if (count < sizeof(struct info)) {					    \

WARNING:LONG_LINE: line over 80 characters
#703: FILE: security/provenance/fs.c:703:
+			return -ENOMEM; }						    \

WARNING:LONG_LINE: line over 80 characters
#704: FILE: security/provenance/fs.c:704:
+		list_for_each_safe(listentry, listtmp, &filters) {			    \

WARNING:LONG_LINE: line over 80 characters
#705: FILE: security/provenance/fs.c:705:
+			tmp = list_entry(listentry, struct filters, list);		    \

WARNING:LONG_LINE: line over 80 characters
#706: FILE: security/provenance/fs.c:706:
+			if (count < pos + sizeof(struct info)) {			    \

WARNING:LONG_LINE: line over 80 characters
#707: FILE: security/provenance/fs.c:707:
+				return -ENOMEM; }					    \

WARNING:LONG_LINE: line over 80 characters
#708: FILE: security/provenance/fs.c:708:
+			if (copy_to_user(buf + pos, &(tmp->filter), sizeof(struct info))) { \

WARNING:LONG_LINE: line over 80 characters
#709: FILE: security/provenance/fs.c:709:
+				return -EAGAIN; }					    \

WARNING:LONG_LINE: line over 80 characters
#710: FILE: security/provenance/fs.c:710:
+			pos += sizeof(struct info);					    \

WARNING:LONG_LINE: line over 80 characters
#711: FILE: security/provenance/fs.c:711:
+		}									    \

WARNING:LONG_LINE: line over 80 characters
#712: FILE: security/provenance/fs.c:712:
+		return pos;								    \

WARNING:LONG_LINE: line over 80 characters
#887: FILE: security/provenance/fs.c:887:
+#define hash_filters(filters, filters_type, tmp, tmp_type)						 \

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#887: FILE: security/provenance/fs.c:887:
+#define hash_filters(filters, filters_type, tmp, tmp_type)						 \
+	do {												 \
+		list_for_each_safe(listentry, listtmp, &filters) {					 \
+			tmp = list_entry(listentry, struct filters_type, list);				 \
+			rc = crypto_shash_update(hashdesc, (u8 *)&tmp->filter, sizeof(struct tmp_type)); \
+			if (rc) {									 \
+				pr_err("Provenance: error updating hash.");				 \
+				pos = -EAGAIN;								 \
+				goto out;								 \
+			}										 \
+		}											 \
+	} while (0)

WARNING:LONG_LINE: line over 80 characters
#888: FILE: security/provenance/fs.c:888:
+	do {												 \

WARNING:LONG_LINE: line over 80 characters
#889: FILE: security/provenance/fs.c:889:
+		list_for_each_safe(listentry, listtmp, &filters) {					 \

WARNING:LONG_LINE: line over 80 characters
#890: FILE: security/provenance/fs.c:890:
+			tmp = list_entry(listentry, struct filters_type, list);				 \

WARNING:LONG_LINE: line over 80 characters
#891: FILE: security/provenance/fs.c:891:
+			rc = crypto_shash_update(hashdesc, (u8 *)&tmp->filter, sizeof(struct tmp_type)); \

WARNING:LONG_LINE: line over 80 characters
#892: FILE: security/provenance/fs.c:892:
+			if (rc) {									 \

WARNING:LONG_LINE: line over 80 characters
#893: FILE: security/provenance/fs.c:893:
+				pr_err("Provenance: error updating hash.");				 \

WARNING:LONG_LINE: line over 80 characters
#894: FILE: security/provenance/fs.c:894:
+				pos = -EAGAIN;								 \

WARNING:LONG_LINE: line over 80 characters
#895: FILE: security/provenance/fs.c:895:
+				goto out;								 \

WARNING:LONG_LINE: line over 80 characters
#896: FILE: security/provenance/fs.c:896:
+			}										 \

WARNING:LONG_LINE: line over 80 characters
#897: FILE: security/provenance/fs.c:897:
+		}											 \

WARNING:LONG_LINE: line over 80 characters
#966: FILE: security/provenance/fs.c:966:
+	hash_filters(ingress_ipv4filters, ipv4_filters, ipv4_tmp, prov_ipv4_filter);

WARNING:LONG_LINE: line over 80 characters
#968: FILE: security/provenance/fs.c:968:
+	hash_filters(egress_ipv4filters, ipv4_filters, ipv4_tmp, prov_ipv4_filter);

WARNING:LONG_LINE: line over 80 characters
#1083: FILE: security/provenance/fs.c:1083:
+#define prov_create_file(name, perm, fun_ptr)					      \

WARNING:LONG_LINE: line over 80 characters
#1084: FILE: security/provenance/fs.c:1084:
+	do {									      \

WARNING:LONG_LINE: line over 80 characters
#1085: FILE: security/provenance/fs.c:1085:
+		dentry = securityfs_create_file(name, perm, prov_dir, NULL, fun_ptr); \

WARNING:LONG_LINE: line over 80 characters
#1086: FILE: security/provenance/fs.c:1086:
+		provenance_mark_as_opaque_dentry(dentry);			      \

total: 0 errors, 66 warnings, 1141 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

security/provenance/fs.c has style problems, please review.
---------------------------
security/provenance/hooks.c
---------------------------
WARNING:LONG_LINE: line over 80 characters
#119: FILE: security/provenance/hooks.c:119:
+				uses_two(RL_PROC_READ, cprov, tprov, NULL, clone_flags);

WARNING:LONG_LINE: line over 80 characters
#120: FILE: security/provenance/hooks.c:120:
+				informs(RL_CLONE, tprov, ntprov, NULL, clone_flags);

WARNING:LONG_LINE: line over 80 characters
#178: FILE: security/provenance/hooks.c:178:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#184: FILE: security/provenance/hooks.c:184:
+			rc = uses(RL_PTRACE_READ, ccprov, tprov, cprov, NULL, 0);

WARNING:LONG_LINE: line over 80 characters
#191: FILE: security/provenance/hooks.c:191:
+			rc = generates(RL_PTRACE_ATTACH, cprov, tprov, ccprov, NULL, 0);

WARNING:LONG_LINE: line over 80 characters
#285: FILE: security/provenance/hooks.c:285:
+	spin_lock_irqsave_nested(prov_lock(old_prov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE_COMMENT: line over 80 characters
#287: FILE: security/provenance/hooks.c:287:
+		// Here we use current->provenance instead of calling get_task_provenance

WARNING:LONG_LINE: line over 80 characters
#292: FILE: security/provenance/hooks.c:292:
+			rc = generates(RL_CLONE_MEM, old_prov, tprov, nprov, NULL, 0);

WARNING:LONG_LINE_COMMENT: line over 80 characters
#302: FILE: security/provenance/hooks.c:302:
+ * This hook is triggered when transfering data from original creds to new creds.

WARNING:LONG_LINE: line over 80 characters
#348: FILE: security/provenance/hooks.c:348:
+	spin_lock_irqsave_nested(prov_lock(old_prov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#415: FILE: security/provenance/hooks.c:415:
+static int provenance_task_kill(struct task_struct *p, struct kernel_siginfo *info,

WARNING:LONG_LINE: line over 80 characters
#502: FILE: security/provenance/hooks.c:502:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#564: FILE: security/provenance/hooks.c:564:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#633: FILE: security/provenance/hooks.c:633:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#660: FILE: security/provenance/hooks.c:660:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE_COMMENT: line over 80 characters
#671: FILE: security/provenance/hooks.c:671:
+ *	@dir contains the inode structure of parent directory of the symbolic link.

WARNING:LONG_LINE: line over 80 characters
#690: FILE: security/provenance/hooks.c:690:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#728: FILE: security/provenance/hooks.c:728:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#789: FILE: security/provenance/hooks.c:789:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#827: FILE: security/provenance/hooks.c:827:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#859: FILE: security/provenance/hooks.c:859:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#911: FILE: security/provenance/hooks.c:911:
+		prov_bloom_merge(prov_taint(prov_elt(prov)), prov_taint(setting));

WARNING:LONG_LINE: line over 80 characters
#951: FILE: security/provenance/hooks.c:951:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#953: FILE: security/provenance/hooks.c:953:
+	record_write_xattr(RL_SETXATTR, iprov, tprov, cprov, name, value, size, flags);

WARNING:LONG_LINE: line over 80 characters
#989: FILE: security/provenance/hooks.c:989:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1021: FILE: security/provenance/hooks.c:1021:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1059: FILE: security/provenance/hooks.c:1059:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1061: FILE: security/provenance/hooks.c:1061:
+	rc = record_write_xattr(RL_RMVXATTR, iprov, tprov, cprov, name, NULL, 0, 0);

WARNING:LONG_LINE: line over 80 characters
#1177: FILE: security/provenance/hooks.c:1177:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1181: FILE: security/provenance/hooks.c:1181:
+			rc = generates(RL_WRITE, cprov, tprov, iprov, file, mask);

WARNING:LONG_LINE: line over 80 characters
#1208: FILE: security/provenance/hooks.c:1208:
+			rc = generates(RL_WRITE, cprov, tprov, iprov, file, mask);

WARNING:LONG_LINE: line over 80 characters
#1258: FILE: security/provenance/hooks.c:1258:
+	spin_lock_irqsave_nested(prov_lock(inprov), irqflags, PROVENANCE_LOCK_INODE);

WARNING:LONG_LINE: line over 80 characters
#1282: FILE: security/provenance/hooks.c:1282:
+	spin_lock_irqsave_nested(prov_lock(iprov), irqflags, PROVENANCE_LOCK_INODE);

WARNING:LONG_LINE: line over 80 characters
#1285: FILE: security/provenance/hooks.c:1285:
+		rc = record_influences_kernel(RL_LOAD_UNKNOWN, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1288: FILE: security/provenance/hooks.c:1288:
+		rc = record_influences_kernel(RL_LOAD_FIRMWARE, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1291: FILE: security/provenance/hooks.c:1291:
+		rc = record_influences_kernel(RL_LOAD_FIRMWARE_PREALLOC_BUFFER, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1294: FILE: security/provenance/hooks.c:1294:
+		rc = record_influences_kernel(RL_LOAD_MODULE, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1297: FILE: security/provenance/hooks.c:1297:
+		rc = record_influences_kernel(RL_LOAD_KEXEC_IMAGE, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1300: FILE: security/provenance/hooks.c:1300:
+		rc = record_influences_kernel(RL_LOAD_KEXEC_INITRAMFS, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1303: FILE: security/provenance/hooks.c:1303:
+		rc = record_influences_kernel(RL_LOAD_POLICY, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1306: FILE: security/provenance/hooks.c:1306:
+		rc = record_influences_kernel(RL_LOAD_CERTIFICATE, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1309: FILE: security/provenance/hooks.c:1309:
+		rc = record_influences_kernel(RL_LOAD_UNDEFINED, iprov, tprov, file);

WARNING:LONG_LINE: line over 80 characters
#1341: FILE: security/provenance/hooks.c:1341:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1373: FILE: security/provenance/hooks.c:1373:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1399: FILE: security/provenance/hooks.c:1399:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1432: FILE: security/provenance/hooks.c:1432:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1491: FILE: security/provenance/hooks.c:1491:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1498: FILE: security/provenance/hooks.c:1498:
+			rc = uses(RL_MMAP_WRITE, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1502: FILE: security/provenance/hooks.c:1502:
+			rc = uses(RL_MMAP_READ, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1506: FILE: security/provenance/hooks.c:1506:
+			rc = uses(RL_MMAP_EXEC, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1511: FILE: security/provenance/hooks.c:1511:
+			rc = uses(RL_MMAP_WRITE_PRIVATE, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1515: FILE: security/provenance/hooks.c:1515:
+			rc = uses(RL_MMAP_READ_PRIVATE, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1519: FILE: security/provenance/hooks.c:1519:
+			rc = uses(RL_MMAP_EXEC_PRIVATE, iprov, tprov, cprov, file, flags);

WARNING:LONG_LINE: line over 80 characters
#1562: FILE: security/provenance/hooks.c:1562:
+						 irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1563: FILE: security/provenance/hooks.c:1563:
+			spin_lock_nested(prov_lock(iprov), PROVENANCE_LOCK_INODE);

WARNING:LONG_LINE: line over 80 characters
#1605: FILE: security/provenance/hooks.c:1605:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1652: FILE: security/provenance/hooks.c:1652:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1698: FILE: security/provenance/hooks.c:1698:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1766: FILE: security/provenance/hooks.c:1766:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1867: FILE: security/provenance/hooks.c:1867:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1918: FILE: security/provenance/hooks.c:1918:
+static int provenance_shm_shmat(struct kern_ipc_perm *shp, char __user *shmaddr, int shmflg)

WARNING:LONG_LINE: line over 80 characters
#1928: FILE: security/provenance/hooks.c:1928:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#1936: FILE: security/provenance/hooks.c:1936:
+		rc = generates(RL_SH_ATTACH_WRITE, cprov, tprov, sprov, NULL, shmflg);

WARNING:LONG_LINE: line over 80 characters
#1967: FILE: security/provenance/hooks.c:1967:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2055: FILE: security/provenance/hooks.c:2055:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2078: FILE: security/provenance/hooks.c:2078:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2171: FILE: security/provenance/hooks.c:2171:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2210: FILE: security/provenance/hooks.c:2210:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2248: FILE: security/provenance/hooks.c:2248:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2312: FILE: security/provenance/hooks.c:2312:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE_COMMENT: line over 80 characters
#2374: FILE: security/provenance/hooks.c:2374:
+	    sock->sk->sk_type != SOCK_DGRAM) { // datagran handled by unix_may_send

WARNING:LONG_LINE: line over 80 characters
#2382: FILE: security/provenance/hooks.c:2382:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2480: FILE: security/provenance/hooks.c:2480:
+	spin_lock_irqsave_nested(prov_lock(cprov), irqflags, PROVENANCE_LOCK_PROC);

WARNING:LONG_LINE: line over 80 characters
#2510: FILE: security/provenance/hooks.c:2510:
+	spin_lock_irqsave_nested(prov_lock(iprov), irqflags, PROVENANCE_LOCK_SOCKET);

WARNING:LONG_LINE: line over 80 characters
#2705: FILE: security/provenance/hooks.c:2705:
+		get_random_bytes(prov_elt(sbprov)->sb_info.uuid, 16 * sizeof(uint8_t));

WARNING:LONG_LINE: line over 80 characters
#2739: FILE: security/provenance/hooks.c:2739:
+	LSM_HOOK_INIT(inode_alloc_security,     provenance_inode_alloc_security),

WARNING:LONG_LINE: line over 80 characters
#2770: FILE: security/provenance/hooks.c:2770:
+	LSM_HOOK_INIT(file_splice_pipe_to_pipe, provenance_file_splice_pipe_to_pipe),

WARNING:LONG_LINE: line over 80 characters
#2775: FILE: security/provenance/hooks.c:2775:
+	LSM_HOOK_INIT(msg_msg_alloc_security,   provenance_msg_msg_alloc_security),

WARNING:LONG_LINE: line over 80 characters
#2776: FILE: security/provenance/hooks.c:2776:
+	LSM_HOOK_INIT(msg_msg_free_security,    provenance_msg_msg_free_security),

WARNING:LONG_LINE: line over 80 characters
#2797: FILE: security/provenance/hooks.c:2797:
+	LSM_HOOK_INIT(socket_sendmsg_always,    provenance_socket_sendmsg_always),

WARNING:LONG_LINE: line over 80 characters
#2798: FILE: security/provenance/hooks.c:2798:
+	LSM_HOOK_INIT(socket_recvmsg_always,    provenance_socket_recvmsg_always),

WARNING:LONG_LINE: line over 80 characters
#2812: FILE: security/provenance/hooks.c:2812:
+	LSM_HOOK_INIT(bprm_committing_creds,    provenance_bprm_committing_creds),

WARNING:LONG_LINE: line over 80 characters
#2870: FILE: security/provenance/hooks.c:2870:
+						   sizeof(struct long_boot_buffer),

total: 0 errors, 83 warnings, 2950 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

security/provenance/hooks.c has style problems, please review.
-----------------------------
security/provenance/machine.c
-----------------------------
total: 0 errors, 0 warnings, 51 lines checked

security/provenance/machine.c has no obvious style problems and is ready for submission.
-------------------------------
security/provenance/memcpy_ss.c
-------------------------------
WARNING:INCLUDE_LINUX: Use #include <linux/bug.h> instead of <asm/bug.h>
#18: FILE: security/provenance/memcpy_ss.c:18:
+#include <asm/bug.h>

total: 0 errors, 1 warnings, 66 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

security/provenance/memcpy_ss.c has style problems, please review.
-------------------------------
security/provenance/netfilter.c
-------------------------------
total: 0 errors, 0 warnings, 117 lines checked

security/provenance/netfilter.c has no obvious style problems and is ready for submission.
-------------------------------
security/provenance/propagate.c
-------------------------------
total: 0 errors, 0 warnings, 43 lines checked

security/provenance/propagate.c has no obvious style problems and is ready for submission.
---------------------------
security/provenance/query.c
---------------------------
total: 0 errors, 0 warnings, 49 lines checked

security/provenance/query.c has no obvious style problems and is ready for submission.
---------------------------
security/provenance/relay.c
---------------------------
WARNING:AVOID_EXTERNS: externs should be avoided in .c files
#228: FILE: security/provenance/relay.c:228:
+void refresh_prov_machine(void);

WARNING:LONG_LINE: line over 80 characters
#315: FILE: security/provenance/relay.c:315:
+	struct boot_buffer *tmp = kmem_cache_zalloc(boot_buffer_cache, GFP_ATOMIC);

total: 0 errors, 2 warnings, 440 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

security/provenance/relay.c has style problems, please review.
--------------------------
security/provenance/type.c
--------------------------
WARNING:LONG_LINE: line over 80 characters
#19: FILE: security/provenance/type.c:19:
+static const char RL_STR_UNKNOWN[] = "unknown";                                                         // unknown relation should not happen

WARNING:LONG_LINE: line over 80 characters
#20: FILE: security/provenance/type.c:20:
+static const char RL_STR_READ[] = "read";                                                               // read to inode

WARNING:LONG_LINE: line over 80 characters
#21: FILE: security/provenance/type.c:21:
+static const char RL_STR_READ_IOCTL[] = "read_ioctl";                                                   // ioctl read

WARNING:LONG_LINE: line over 80 characters
#22: FILE: security/provenance/type.c:22:
+static const char RL_STR_WRITE[] = "write";                                                             // write to inode

WARNING:LONG_LINE: line over 80 characters
#23: FILE: security/provenance/type.c:23:
+static const char RL_STR_WRITE_IOCTL[] = "write_ioctl";                                                 // ioctl write

WARNING:LONG_LINE: line over 80 characters
#24: FILE: security/provenance/type.c:24:
+static const char RL_STR_CLONE_MEM[] = "clone_mem";                                                     // memory copy on clone

WARNING:LONG_LINE: line over 80 characters
#25: FILE: security/provenance/type.c:25:
+static const char RL_STR_MSG_CREATE[] = "msg_create";                                                   // create msg (IPC message passing)

WARNING:LONG_LINE: line over 80 characters
#26: FILE: security/provenance/type.c:26:
+static const char RL_STR_SOCKET_CREATE[] = "socket_create";                                             // create socket

WARNING:LONG_LINE: line over 80 characters
#27: FILE: security/provenance/type.c:27:
+static const char RL_STR_SOCKET_PAIR_CREATE[] = "socket_pair_create";                                   // create socket pair

WARNING:LONG_LINE: line over 80 characters
#28: FILE: security/provenance/type.c:28:
+static const char RL_STR_INODE_CREATE[] = "inode_create";                                               // create inode

WARNING:LONG_LINE: line over 80 characters
#29: FILE: security/provenance/type.c:29:
+static const char RL_STR_SETUID[] = "setuid";                                                           // setuid

WARNING:LONG_LINE: line over 80 characters
#30: FILE: security/provenance/type.c:30:
+static const char RL_STR_SETGID[] = "setpgid";                                                          // setpgid

WARNING:LONG_LINE: line over 80 characters
#31: FILE: security/provenance/type.c:31:
+static const char RL_STR_GETGID[] = "getpgid";                                                          // getpgid

WARNING:LONG_LINE: line over 80 characters
#32: FILE: security/provenance/type.c:32:
+static const char RL_STR_SH_WRITE[] = "sh_write";                                                       // writing to shared state

WARNING:LONG_LINE: line over 80 characters
#33: FILE: security/provenance/type.c:33:
+static const char RL_STR_PROC_WRITE[] = "memory_write";                                                 // writing to process memory (i.e. shared between thread)

WARNING:LONG_LINE: line over 80 characters
#34: FILE: security/provenance/type.c:34:
+static const char RL_STR_BIND[] = "bind";                                                               // socket bind operation

WARNING:LONG_LINE: line over 80 characters
#35: FILE: security/provenance/type.c:35:
+static const char RL_STR_CONNECT[] = "connect";                                                         // socket connection operation

WARNING:LONG_LINE: line over 80 characters
#36: FILE: security/provenance/type.c:36:
+static const char RL_STR_CONNECT_UNIX_STREAM[] = "connect_unix_stream";                                 // unix stream socket connection operation

WARNING:LONG_LINE: line over 80 characters
#37: FILE: security/provenance/type.c:37:
+static const char RL_STR_LISTEN[] = "listen";                                                           // socket listen operation

WARNING:LONG_LINE: line over 80 characters
#38: FILE: security/provenance/type.c:38:
+static const char RL_STR_ACCEPT[] = "accept";                                                           // socket accept operation

WARNING:LONG_LINE: line over 80 characters
#39: FILE: security/provenance/type.c:39:
+static const char RL_STR_OPEN[] = "open";                                                               // file open operation

WARNING:LONG_LINE: line over 80 characters
#40: FILE: security/provenance/type.c:40:
+static const char RL_STR_FILE_RCV[] = "file_rcv";                                                       // open file descriptor recevied through IPC

WARNING:LONG_LINE: line over 80 characters
#41: FILE: security/provenance/type.c:41:
+static const char RL_STR_FILE_LOCK[] = "file_lock";                                                     // represent file lock operation

WARNING:LONG_LINE: line over 80 characters
#42: FILE: security/provenance/type.c:42:
+static const char RL_STR_FILE_SIGIO[] = "file_sigio";                                                   // represent IO signal

WARNING:LONG_LINE: line over 80 characters
#43: FILE: security/provenance/type.c:43:
+static const char RL_STR_VERSION[] = "version_entity";                                                  // connect version of entity object

WARNING:LONG_LINE: line over 80 characters
#44: FILE: security/provenance/type.c:44:
+static const char RL_STR_MUNMAP[] = "munmap";                                                           // munmap operation

WARNING:LONG_LINE: line over 80 characters
#45: FILE: security/provenance/type.c:45:
+static const char RL_STR_SHMDT[] = "shmdt";                                                             // shmdt operation

WARNING:LONG_LINE: line over 80 characters
#46: FILE: security/provenance/type.c:46:
+static const char RL_STR_LINK[] = "link";                                                               // create a link

WARNING:LONG_LINE: line over 80 characters
#47: FILE: security/provenance/type.c:47:
+static const char RL_STR_RENAME[] = "rename";                                                           // rename inode

WARNING:LONG_LINE: line over 80 characters
#48: FILE: security/provenance/type.c:48:
+static const char RL_STR_UNLINK[] = "unlink";                                                           // delete a link

WARNING:LONG_LINE: line over 80 characters
#49: FILE: security/provenance/type.c:49:
+static const char RL_STR_SYMLINK[] = "symlink";                                                         // create a symlink

WARNING:LONG_LINE: line over 80 characters
#50: FILE: security/provenance/type.c:50:
+static const char RL_STR_SPLICE_IN[] = "splice_in";                                                     // pipe splice operation from in file

WARNING:LONG_LINE: line over 80 characters
#51: FILE: security/provenance/type.c:51:
+static const char RL_STR_SPLICE_OUT[] = "splice_out";                                                   // pipe splice operation to out file

WARNING:LONG_LINE: line over 80 characters
#52: FILE: security/provenance/type.c:52:
+static const char RL_STR_SETATTR[] = "setattr";                                                         // setattr operation (task -> iattr)

WARNING:LONG_LINE: line over 80 characters
#53: FILE: security/provenance/type.c:53:
+static const char RL_STR_SETATTR_INODE[] = "setattr_inode";                                             // setattr operation (iattr -> inode)

WARNING:LONG_LINE: line over 80 characters
#54: FILE: security/provenance/type.c:54:
+static const char RL_STR_ACCEPT_SOCKET[] = "accept_socket";                                             // accept operation (parent -> child socket)

WARNING:LONG_LINE: line over 80 characters
#55: FILE: security/provenance/type.c:55:
+static const char RL_STR_SETXATTR[] = "setxattr";                                                       // setxattr operation (task -> xattr)

WARNING:LONG_LINE: line over 80 characters
#56: FILE: security/provenance/type.c:56:
+static const char RL_STR_SETXATTR_INODE[] = "setxattr_inode";                                           // setxattr operation (xattr -> inode)

WARNING:LONG_LINE: line over 80 characters
#57: FILE: security/provenance/type.c:57:
+static const char RL_STR_RMVXATTR[] = "removexattr";                                                    // remove xattr operation (task -> xattr)

WARNING:LONG_LINE: line over 80 characters
#58: FILE: security/provenance/type.c:58:
+static const char RL_STR_RMVXATTR_INODE[] = "removexattr_inode";                                        // remove xattr operation (xattr -> inode)

WARNING:LONG_LINE: line over 80 characters
#59: FILE: security/provenance/type.c:59:
+static const char RL_STR_NAMED[] = "named";                                                             // connect path to inode

WARNING:LONG_LINE: line over 80 characters
#60: FILE: security/provenance/type.c:60:
+static const char RL_STR_ADDRESSED[] = "addressed";                                                     // connect address to inode

WARNING:LONG_LINE: line over 80 characters
#61: FILE: security/provenance/type.c:61:
+static const char RL_STR_EXEC[] = "exec";                                                               // exec operation

WARNING:LONG_LINE: line over 80 characters
#62: FILE: security/provenance/type.c:62:
+static const char RL_STR_EXEC_TASK[] = "exec_task";                                                     // exec operation

WARNING:LONG_LINE: line over 80 characters
#63: FILE: security/provenance/type.c:63:
+static const char RL_STR_PCK_CNT[] = "packet_content";                                                  // connect netwrok packet to its content

WARNING:LONG_LINE: line over 80 characters
#64: FILE: security/provenance/type.c:64:
+static const char RL_STR_CLONE[] = "clone";                                                             // clone operation

WARNING:LONG_LINE: line over 80 characters
#65: FILE: security/provenance/type.c:65:
+static const char RL_STR_VERSION_TASK[] = "version_activity";                                           // connection two versions of an activity

WARNING:LONG_LINE: line over 80 characters
#66: FILE: security/provenance/type.c:66:
+static const char RL_STR_SEARCH[] = "search";                                                           // search operation on directory

WARNING:LONG_LINE: line over 80 characters
#67: FILE: security/provenance/type.c:67:
+static const char RL_STR_GETATTR[] = "getattr";                                                         // getattr operation

WARNING:LONG_LINE: line over 80 characters
#68: FILE: security/provenance/type.c:68:
+static const char RL_STR_GETXATTR[] = "getxattr";                                                       // getxattr operation (xattr -> process)

WARNING:LONG_LINE: line over 80 characters
#69: FILE: security/provenance/type.c:69:
+static const char RL_STR_GETXATTR_INODE[] = "getxattr_inode";                                           // getxattr operation (inode -> xattr)

WARNING:LONG_LINE: line over 80 characters
#70: FILE: security/provenance/type.c:70:
+static const char RL_STR_LSTXATTR[] = "listxattr";                                                      // listxattr operation

WARNING:LONG_LINE: line over 80 characters
#71: FILE: security/provenance/type.c:71:
+static const char RL_STR_READ_LINK[] = "read_link";                                                     // readlink operation

WARNING:LONG_LINE: line over 80 characters
#72: FILE: security/provenance/type.c:72:
+static const char RL_STR_MMAP_READ[] = "mmap_read";                                                     // mmap mounting with read perm

WARNING:LONG_LINE: line over 80 characters
#73: FILE: security/provenance/type.c:73:
+static const char RL_STR_MMAP_EXEC[] = "mmap_exec";                                                     // mmap mounting with exec perm

WARNING:LONG_LINE: line over 80 characters
#74: FILE: security/provenance/type.c:74:
+static const char RL_STR_MMAP_WRITE[] = "mmap_write";                                                   // mmap mounting with write perm

WARNING:LONG_LINE: line over 80 characters
#75: FILE: security/provenance/type.c:75:
+static const char RL_STR_MMAP_READ_PRIVATE[] = "mmap_read_private";                                     // mmap private mounting with read perm

WARNING:LONG_LINE: line over 80 characters
#76: FILE: security/provenance/type.c:76:
+static const char RL_STR_MMAP_EXEC_PRIVATE[] = "mmap_exec_private";                                     // mmap private mounting with exec perm

WARNING:LONG_LINE: line over 80 characters
#77: FILE: security/provenance/type.c:77:
+static const char RL_STR_MMAP_WRITE_PRIVATE[] = "mmap_write_private";                                   // mmap private  mounting with write perm

WARNING:LONG_LINE: line over 80 characters
#78: FILE: security/provenance/type.c:78:
+static const char RL_STR_SH_READ[] = "sh_read";                                                         // sh_read operation

WARNING:LONG_LINE: line over 80 characters
#79: FILE: security/provenance/type.c:79:
+static const char RL_STR_PROC_READ[] = "memory_read";                                                   // read from process memory

WARNING:LONG_LINE: line over 80 characters
#80: FILE: security/provenance/type.c:80:
+static const char RL_STR_SND[] = "send";                                                                // send over socket

WARNING:LONG_LINE: line over 80 characters
#81: FILE: security/provenance/type.c:81:
+static const char RL_STR_SND_PACKET[] = "send_packet";                                                  // connect socket to packet on send operation

WARNING:LONG_LINE: line over 80 characters
#82: FILE: security/provenance/type.c:82:
+static const char RL_STR_SND_UNIX[] = "send_unix";                                                      // send over unix socket

WARNING:LONG_LINE: line over 80 characters
#83: FILE: security/provenance/type.c:83:
+static const char RL_STR_SND_MSG[] = "send_msg";                                                        // send message

WARNING:LONG_LINE: line over 80 characters
#84: FILE: security/provenance/type.c:84:
+static const char RL_STR_SND_MSG_Q[] = "send_msg_queue";                                                // send message to queue

WARNING:LONG_LINE: line over 80 characters
#85: FILE: security/provenance/type.c:85:
+static const char RL_STR_RCV[] = "receive";                                                             // receive socket operation

WARNING:LONG_LINE: line over 80 characters
#86: FILE: security/provenance/type.c:86:
+static const char RL_STR_RCV_PACKET[] = "receive_packet";                                               // connect packet to socket on receive operation

WARNING:LONG_LINE: line over 80 characters
#87: FILE: security/provenance/type.c:87:
+static const char RL_STR_RCV_UNIX[] = "receive_unix";                                                   // receive on unix socket

WARNING:LONG_LINE: line over 80 characters
#88: FILE: security/provenance/type.c:88:
+static const char RL_STR_RCV_MSG[] = "receive_msg";                                                     // receive message

WARNING:LONG_LINE: line over 80 characters
#89: FILE: security/provenance/type.c:89:
+static const char RL_STR_RCV_MSG_Q[] = "receive_msg_queue";                                             // receive message from queue

WARNING:LONG_LINE: line over 80 characters
#90: FILE: security/provenance/type.c:90:
+static const char RL_STR_PERM_READ[] = "perm_read";                                                     // check read permission

WARNING:LONG_LINE: line over 80 characters
#91: FILE: security/provenance/type.c:91:
+static const char RL_STR_PERM_WRITE[] = "perm_write";                                                   // check write permission

WARNING:LONG_LINE: line over 80 characters
#92: FILE: security/provenance/type.c:92:
+static const char RL_STR_PERM_EXEC[] = "perm_exec";                                                     // check exec permission

WARNING:LONG_LINE: line over 80 characters
#93: FILE: security/provenance/type.c:93:
+static const char RL_STR_PERM_APPEND[] = "perm_append";                                                 // check append permission

WARNING:LONG_LINE: line over 80 characters
#94: FILE: security/provenance/type.c:94:
+static const char RL_STR_TERMINATE_TASK[] = "terminate_task";                                           // created when task data structure is freed

WARNING:LONG_LINE: line over 80 characters
#95: FILE: security/provenance/type.c:95:
+static const char RL_STR_TERMINATE_PROC[] = "terminate_proc";                                           // created when cred data structure is freed

WARNING:LONG_LINE: line over 80 characters
#96: FILE: security/provenance/type.c:96:
+static const char RL_STR_FREED[] = "free";                                                              // created when an inode is freed

WARNING:LONG_LINE: line over 80 characters
#97: FILE: security/provenance/type.c:97:
+static const char RL_STR_ARG[] = "arg";                                                                 // connect arg value to process

WARNING:LONG_LINE: line over 80 characters
#98: FILE: security/provenance/type.c:98:
+static const char RL_STR_ENV[] = "env";                                                                 // connect env value to process

WARNING:LONG_LINE: line over 80 characters
#99: FILE: security/provenance/type.c:99:
+static const char RL_STR_LOG[] = "log";                                                                 // connect string to task

WARNING:LONG_LINE: line over 80 characters
#100: FILE: security/provenance/type.c:100:
+static const char RL_STR_SH_ATTACH_READ[] = "sh_attach_read";                                           // attach sh with read perm

WARNING:LONG_LINE: line over 80 characters
#101: FILE: security/provenance/type.c:101:
+static const char RL_STR_SH_ATTACH_WRITE[] = "sh_attach_write";                                         // attach sh with write perm

WARNING:LONG_LINE: line over 80 characters
#102: FILE: security/provenance/type.c:102:
+static const char RL_STR_SH_CREATE_READ[] = "sh_create_read";                                           // sh create with read perm

WARNING:LONG_LINE: line over 80 characters
#103: FILE: security/provenance/type.c:103:
+static const char RL_STR_SH_CREATE_WRITE[] = "sh_create_write";                                         // sh create with write perm

WARNING:LONG_LINE: line over 80 characters
#104: FILE: security/provenance/type.c:104:
+static const char RL_STR_LOAD_FILE[] = "load_file";                                                     // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#105: FILE: security/provenance/type.c:105:
+static const char RL_STR_RAN_ON[] = "ran_on";                                                           // task run on this machine

WARNING:LONG_LINE: line over 80 characters
#106: FILE: security/provenance/type.c:106:
+static const char RL_STR_LOAD_UNKNOWN[] = "load_unknown";                                               // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#107: FILE: security/provenance/type.c:107:
+static const char RL_STR_LOAD_FIRMWARE[] = "load_firmware";                                             // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#108: FILE: security/provenance/type.c:108:
+static const char RL_STR_LOAD_FIRMWARE_PREALLOC_BUFFER[] = "load_firmware_prealloc_buffer";             // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#109: FILE: security/provenance/type.c:109:
+static const char RL_STR_LOAD_MODULE[] = "load_module";                                                 // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#110: FILE: security/provenance/type.c:110:
+static const char RL_STR_LOAD_KEXEC_IMAGE[] = "load_kexec_image";                                       // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#111: FILE: security/provenance/type.c:111:
+static const char RL_STR_LOAD_KEXEC_INITRAMFS[] = "load_kexec_initramfs";                               // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#112: FILE: security/provenance/type.c:112:
+static const char RL_STR_LOAD_POLICY[] = "load_policy";                                                 // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#113: FILE: security/provenance/type.c:113:
+static const char RL_STR_LOAD_CERTIFICATE[] = "load_certificate";                                       // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#114: FILE: security/provenance/type.c:114:
+static const char RL_STR_LOAD_UNDEFINED[] = "load_undefined";                                           // load file into kernel

WARNING:LONG_LINE: line over 80 characters
#115: FILE: security/provenance/type.c:115:
+static const char RL_STR_PTRACE_ATTACH[] = "ptrace_attach";                                             // ptrace attach effect on memory

WARNING:LONG_LINE: line over 80 characters
#116: FILE: security/provenance/type.c:116:
+static const char RL_STR_PTRACE_READ[] = "ptrace_read";                                                 // ptrace read from mem

WARNING:LONG_LINE: line over 80 characters
#117: FILE: security/provenance/type.c:117:
+static const char RL_STR_PTRACE_ATTACH_TASK[] = "ptrace_attach_task";                                   // write info via ptrace effect on task

WARNING:LONG_LINE: line over 80 characters
#118: FILE: security/provenance/type.c:118:
+static const char RL_STR_PTRACE_READ_TASK[] = "ptrace_read_task";                                       // read info via ptrace effect on task

WARNING:LONG_LINE: line over 80 characters
#119: FILE: security/provenance/type.c:119:
+static const char RL_STR_PTRACE_TRACEME[] = "ptrace_traceme";                                           // track ptrace_traceme

WARNING:LONG_LINE: line over 80 characters
#120: FILE: security/provenance/type.c:120:
+static const char RL_STR_DERIVED_DISC[] = "derived_disc";                                               // disclosed type

WARNING:LONG_LINE: line over 80 characters
#121: FILE: security/provenance/type.c:121:
+static const char RL_STR_GENERATED_DISC[] = "generated_disc";                                           // disclosed type

WARNING:LONG_LINE: line over 80 characters
#122: FILE: security/provenance/type.c:122:
+static const char RL_STR_USED_DISC[] = "used_disc";                                                     // disclosed type

WARNING:LONG_LINE: line over 80 characters
#123: FILE: security/provenance/type.c:123:
+static const char RL_STR_INFORMED_DISC[] = "informed_disc";                                             // disclosed type

WARNING:LONG_LINE: line over 80 characters
#124: FILE: security/provenance/type.c:124:
+static const char RL_STR_INFLUENCED_DISC[] = "influenced_disc";                                         // disclosed type

WARNING:LONG_LINE: line over 80 characters
#125: FILE: security/provenance/type.c:125:
+static const char RL_STR_ASSOCIATED_DISC[] = "associated_disc";                                         // disclosed type

WARNING:LONG_LINE_COMMENT: line over 80 characters
#128: FILE: security/provenance/type.c:128:
+static const char ND_STR_UNKNOWN[] = "unknown";                                 // unkown node type should normally not appear

WARNING:LONG_LINE_COMMENT: line over 80 characters
#129: FILE: security/provenance/type.c:129:
+static const char ND_STR_STR[] = "string";                                      // simple string used for disclosed log

WARNING:LONG_LINE_COMMENT: line over 80 characters
#130: FILE: security/provenance/type.c:130:
+static const char ND_STR_TASK[] = "task";                                       // represent a thread from user space POV

WARNING:LONG_LINE_COMMENT: line over 80 characters
#131: FILE: security/provenance/type.c:131:
+static const char ND_STR_INODE_UNKNOWN[] = "inode_unknown";                     // unknown inode type should normally not appear

WARNING:LONG_LINE_COMMENT: line over 80 characters
#132: FILE: security/provenance/type.c:132:
+static const char ND_STR_INODE_LINK[] = "link";                                 // link

WARNING:LONG_LINE_COMMENT: line over 80 characters
#133: FILE: security/provenance/type.c:133:
+static const char ND_STR_INODE_FILE[] = "file";                                 // standard file

WARNING:LONG_LINE_COMMENT: line over 80 characters
#134: FILE: security/provenance/type.c:134:
+static const char ND_STR_INODE_DIRECTORY[] = "directory";                       // directory

WARNING:LONG_LINE_COMMENT: line over 80 characters
#135: FILE: security/provenance/type.c:135:
+static const char ND_STR_INODE_CHAR[] = "char";                                 // character device

WARNING:LONG_LINE_COMMENT: line over 80 characters
#136: FILE: security/provenance/type.c:136:
+static const char ND_STR_INODE_BLOCK[] = "block";                               // block device

WARNING:LONG_LINE_COMMENT: line over 80 characters
#137: FILE: security/provenance/type.c:137:
+static const char ND_STR_INODE_PIPE[] = "pipe";                                 // pipe

WARNING:LONG_LINE_COMMENT: line over 80 characters
#138: FILE: security/provenance/type.c:138:
+static const char ND_STR_INODE_SOCKET[] = "socket";                             // network socket

WARNING:LONG_LINE_COMMENT: line over 80 characters
#139: FILE: security/provenance/type.c:139:
+static const char ND_STR_MSG[] = "msg";                                         // msg as in IPC message passing

WARNING:LONG_LINE_COMMENT: line over 80 characters
#140: FILE: security/provenance/type.c:140:
+static const char ND_STR_SHM[] = "shm";                                         // shared memory

WARNING:LONG_LINE_COMMENT: line over 80 characters
#141: FILE: security/provenance/type.c:141:
+static const char ND_STR_ADDR[] = "address";                                    // network address

WARNING:LONG_LINE_COMMENT: line over 80 characters
#142: FILE: security/provenance/type.c:142:
+static const char ND_STR_SB[] = "sb";                                           // superblock

WARNING:LONG_LINE_COMMENT: line over 80 characters
#143: FILE: security/provenance/type.c:143:
+static const char ND_STR_PATH[] = "path";                                       // path associated with a file

WARNING:LONG_LINE_COMMENT: line over 80 characters
#144: FILE: security/provenance/type.c:144:
+static const char ND_STR_DISC_ENTITY[] = "disc_entity";                         // descilosed node representing an entity

WARNING:LONG_LINE_COMMENT: line over 80 characters
#145: FILE: security/provenance/type.c:145:
+static const char ND_STR_DISC_ACTIVITY[] = "disc_activity";                     // descilosed node representing an activity

WARNING:LONG_LINE_COMMENT: line over 80 characters
#146: FILE: security/provenance/type.c:146:
+static const char ND_STR_DISC_AGENT[] = "disc_agent";                           // disclosed node representing an agent

WARNING:LONG_LINE_COMMENT: line over 80 characters
#147: FILE: security/provenance/type.c:147:
+static const char ND_STR_MACHINE[] = "machine";                                 // machine representing an agent

WARNING:LONG_LINE_COMMENT: line over 80 characters
#148: FILE: security/provenance/type.c:148:
+static const char ND_STR_PACKET[] = "packet";                                   // network packet

WARNING:LONG_LINE_COMMENT: line over 80 characters
#149: FILE: security/provenance/type.c:149:
+static const char ND_STR_IATTR[] = "iattr";                                     // inode attributes value

WARNING:LONG_LINE_COMMENT: line over 80 characters
#150: FILE: security/provenance/type.c:150:
+static const char ND_STR_XATTR[] = "xattr";                                     // extended attributes value

WARNING:LONG_LINE_COMMENT: line over 80 characters
#151: FILE: security/provenance/type.c:151:
+static const char ND_STR_PCKCNT[] = "packet_content";                           // the content of network packet

WARNING:LONG_LINE_COMMENT: line over 80 characters
#152: FILE: security/provenance/type.c:152:
+static const char ND_STR_ARG[] = "argv";                                        // argument passed to a process

WARNING:LONG_LINE_COMMENT: line over 80 characters
#153: FILE: security/provenance/type.c:153:
+static const char ND_STR_ENV[] = "envp";                                        // environment parameter

WARNING:LONG_LINE_COMMENT: line over 80 characters
#154: FILE: security/provenance/type.c:154:
+static const char ND_STR_PROC[] = "process_memory";                             // process memory

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#156: FILE: security/provenance/type.c:156:
+#define MATCH_AND_RETURN(str1, str2, v)	\
+	do { if (strcmp(str1, str2) == 0) { return v; } } while (0)

WARNING:BRACES: braces {} are not necessary for single statement blocks
#157: FILE: security/provenance/type.c:157:
+	do { if (strcmp(str1, str2) == 0) { return v; } } while (0)

WARNING:LONG_LINE: line over 80 characters
#397: FILE: security/provenance/type.c:397:
+	MATCH_AND_RETURN(str, RL_STR_CONNECT_UNIX_STREAM, RL_CONNECT_UNIX_STREAM);

total: 0 errors, 137 warnings, 588 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

security/provenance/type.c has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
